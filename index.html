<!-- <!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="assets/css/styles.css" />
    <title>Ch√∫c m·ª´ng sinh nh·∫≠t!</title>
  </head>
  <body>
    <div class="container" id="container">
      <audio autoplay loop>
        <source src="assets/music/bg-music.mp3" type="audio/mpeg" />
        Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ audio.
      </audio>
    </div>
    <script src="assets/scripts/main.js"></script>
  </body>
</html> -->

<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ch√∫c m·ª´ng sinh nh·∫≠t 3D</title>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        background: url("assets/images/bg.jpg") no-repeat center center fixed;
        background-size: cover;
        height: 100%;
        font-family: "Segoe UI", sans-serif;
      }
      .text3d {
        font-size: 20px;
        color: #fff;
        text-shadow: 0 0 6px #ff69b4;
        font-weight: 500;
        background-color: rgba(255, 255, 255, 0.1);
        padding: 6px 12px;
        border-radius: 18px;
        border: 1px solid rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(3px);
        /* transition: opacity 1s ease-out; */
      }
      audio {
        position: absolute;
        bottom: 20px;
        width: 90%;
        max-width: 400px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 9999;
      }
    </style>
  </head>
  <body>
    <audio autoplay loop>
      <source src="assets/music/bg-music.mp3" type="audio/mpeg" />
      Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ audio.
    </audio>

    <script>
      // Ch·ªù t∆∞∆°ng t√°c ƒë·∫ßu ti√™n r·ªìi m·ªõi ph√°t nh·∫°c
      window.addEventListener(
        "click",
        () => {
          const audio = document.querySelector("audio");
          if (audio && audio.paused) {
            audio
              .play()
              .catch((err) => console.warn("Kh√¥ng th·ªÉ ph√°t nh·∫°c:", err));
          }
        },
        { once: true }
      );

      // (Tu·ª≥ ch·ªçn) B·∫Øt c·∫£ ch·∫°m tr√™n mobile
      window.addEventListener(
        "touchstart",
        () => {
          const audio = document.querySelector("audio");
          if (audio && audio.paused) {
            audio
              .play()
              .catch((err) => console.warn("Kh√¥ng th·ªÉ ph√°t nh·∫°c:", err));
          }
        },
        { once: true }
      );
    </script>

    <script src="https://cdn.jsdelivr.net/npm/three@0.127.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.127.0/examples/js/renderers/CSS3DRenderer.js"></script>

    <script>
      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        1,
        2000
      );
      camera.position.z = 600;

      const renderer = new THREE.CSS3DRenderer();
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      const phrases = [
        "Ch√∫c b·∫°n m·ªôt ng√†y th·∫≠t ƒë·∫πp!",
        "Th√™m tu·ªïi m·ªõi, th√™m y√™u ƒë·ªùi!",
        "Lu√¥n m·ªâm c∆∞·ªùi nh√©!",
        "H·∫°nh ph√∫c v√† th√†nh c√¥ng!",
        "Ch√∫c b·∫°n lu√¥n vui v·∫ª!",
        "M·ªôt nƒÉm tuy·ªát v·ªùi ƒëang ch·ªù ƒë√≥n!",
        "Tu·ªïi m·ªõi th·∫≠t r·ª±c r·ª° nh√©!",
      ];

      for (let i = 0; i < 100; i++) {
        const div = document.createElement("div");
        div.className = "text3d";
        const emojis = ["üéÇ", "üéâ", "‚ú®", "üéÅ", "üíñ", "ü•≥"];
        const prefix = emojis[Math.floor(Math.random() * emojis.length)];
        const suffix = emojis[Math.floor(Math.random() * emojis.length)];
        div.innerText = `${prefix} ${
          phrases[Math.floor(Math.random() * phrases.length)]
        } ${suffix}`;

        const object = new THREE.CSS3DObject(div);
        object.position.set(
          Math.random() * 2000 - 1000,
          Math.random() * 2000 - 1000,
          Math.random() * 2000 - 1000
        );
        scene.add(object);
      }

      function animate() {
        requestAnimationFrame(animate);
        renderer.render(scene, camera);
      }
      animate();

      // G√≥c nh√¨n thay ƒë·ªïi theo con quay h·ªìi chuy·ªÉn
      window.addEventListener(
        "deviceorientation",
        (event) => {
          const beta = event.beta || 0;
          const gamma = event.gamma || 0;
          const x = THREE.MathUtils.degToRad(beta - 45);
          const y = THREE.MathUtils.degToRad(gamma);
          camera.rotation.x = x;
          camera.rotation.y = y;
        },
        true
      );

      window.addEventListener("resize", () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });

      setInterval(() => {
        const div = document.createElement("div");
        div.className = "text3d";

        const text = phrases[Math.floor(Math.random() * phrases.length)];
        const emojis = ["üéÇ", "üéâ", "‚ú®", "üéÅ", "üíñ", "ü•≥"];
        const prefix = emojis[Math.floor(Math.random() * emojis.length)];
        const suffix = emojis[Math.floor(Math.random() * emojis.length)];
        div.innerText = `${prefix} ${text} ${suffix}`;

        const object = new THREE.CSS3DObject(div);

        const vector = new THREE.Vector3();
        camera.getWorldDirection(vector);

        // V·ªã tr√≠ r∆°i = camera v·ªã tr√≠ + h∆∞·ªõng nh√¨n * kho·∫£ng c√°ch
        const zOffset = 1000;
        const pos = camera.position.clone().add(vector.multiplyScalar(zOffset));
        const spread = 400;

        object.position.set(
          pos.x + (Math.random() - 0.5) * spread,
          pos.y + 600, // cao h∆°n t·∫ßm nh√¨n
          pos.z + (Math.random() - 0.5) * spread
        );

        // √Åp d·ª•ng v√†o div (ph·∫£i ƒë·∫£m b·∫£o .text3d c√≥ transition m∆∞·ª£t n·∫øu mu·ªën)
        // div.style.opacity = opacity.toFixed(2);

        scene.add(object);

        // Animation th·ªß c√¥ng: r∆°i xu·ªëng
        let speed = 1 + Math.random(); // t·ªëc ƒë·ªô

        function fall() {
          object.position.y -= speed;
          if (object.position.y < -1000) {
            scene.remove(object);
            return;
          }
          requestAnimationFrame(fall);
        }

        fall();
      }, 500);
    </script>
  </body>
</html>
